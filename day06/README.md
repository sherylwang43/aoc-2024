This is by far the worst and most inefficient code I have ever written but when i tried to make it nicer it broke...So it is messy, but it works!
